#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(13, -10, legend=c(unique(data$site)), cex = 0.5,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "WART"] <- 'darkred'
coldf[coldf == "SBR"] <- 'forestgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'blue'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'orange'
coldf
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1", ylab = "PC2", main = "PCA plot of Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-35, 25, legend=c(unique(data$site)), cex = 0.5,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-35, 25, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-35, 30, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-35, 29, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-35, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "WART"] <- 'darkred'
coldf[coldf == "SBR"] <- 'forestgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'blue'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'orange'
coldf
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1", ylab = "PC2", main = "PCA plot of Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1", ylab = "PC2", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
pc1
summary(pca)
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.4)", ylab = "PC2(13.1)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red','orange'))
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("partial_202107_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
unique(data$site)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
pc1
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
pc1
pc1 <- pc1[0:49]
pc1
pc2 <- pc2[0:49]
pc2
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[0:49]
coldf <- coldf$site[0:49]
coldf
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf %>%
filter(!row_number() %in% c(50))
coldf <- coldf[-c(50), ]
coldf
coldf <- coldf[-c(49), ]
coldf
coldf
coldf <- coldf[-c(49), ]
coldf <- coldf[-c(50), ]
coldf
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
pc1
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
plot(pc1, pc2, col = coldf, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("partial_202107_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
pc1 <- pc1[0:49]
pc2 <- pc2[0:49]
pc1
pc2
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
pc1
plot(pc1, pc2, col = coldf, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("partial_202107_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
#pc1 <- pc1[0:49]
#pc2 <- pc2[0:49]
pc1
pc2
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
pc1
plot(pc1, pc2, col = coldf, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("partial_202107_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
#pc1 <- pc1[0:49]
#pc2 <- pc2[0:49]
pc1
pc1[pc1<40]
pc2[pc2<30]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
pc1
pc1 <- pc1[pc1<40]
pc2 <- pc2[pc2<30]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
pc1
plot(pc1, pc2, col = coldf, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("partial_202107_genera_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("202107_phylum_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
plot(pc1, pc2, col = coldf, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Genera")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-34.5, 28, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-4, 4, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-4, 6, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-6, 6.5, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("202107_phylum_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
pc1 <- pc1[pc1<40]
pc2 <- pc2[pc2<30]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf <- coldf[-c(50), ]
coldf
pc1
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-6, 6.5, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("202107_phylum_with_site.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][5:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
#pc1 <- pc1[pc1<40]
#pc2 <- pc2[pc2<30]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "PNR"] <- 'forestgreen'
coldf[coldf == "RF"] <- 'yellow'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "RRL"] <- 'red'
coldf
coldf
pc1
plot(pc1, pc2, col = coldf$site, pch = 19,
xlab = "PC1(13.9)", ylab = "PC2(10.3)", main = "PCA plot of Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
legend(-6, 6.5, legend=c(unique(data$site)), cex = 1,
fill = c('darkred','forestgreen','yellow','blue','red'))
require(vegan)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'WART')
sum(df1[8,] != 0)
df1 <- df1[8,]
sum(df1[])
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'orange', lwd = 2, cex = 0.5)
df1[][5:ncol(df1)]
x <- df1[][5:ncol(df1)]
# Define a function to calculate the rarefaction curve for a given data set
rarefaction_curve <- function(x) {
n <- length(x) # Number of individuals in the data set
S <- numeric(n) # Number of unique individuals observed at each sampling effort
for(i in 1:n) {
S[i] <- length(unique(sample(x, i)))
}
return(S)
}
# Example usage
set.seed(123) # Set seed for reproducibility
#x <- rpois(100, lambda = 5) # Simulate a data set with Poisson distribution
S <- rarefaction_curve(x) # Calculate the rarefaction curve
plot(S, type = "b", xlab = "Sampling effort", ylab = "Number of unique individuals")
x
len(x)
dim(x)
test_df <- df1[][5:ncol(df1)]
dim(test_df)
# Identify columns with 0 values
zero_cols <- sapply(test_df, function(x) all(x == 0))
# Drop columns with 0 values
test_df <- test_df[, !zero_cols]
dim(test_df)
# Define a function to calculate the rarefaction curve for a given data set
rarefaction_curve <- function(x) {
n <- length(x) # Number of individuals in the data set
S <- numeric(n) # Number of unique individuals observed at each sampling effort
for(i in 1:n) {
S[i] <- length(unique(sample(x, i)))
}
return(S)
}
# Example usage
set.seed(123) # Set seed for reproducibility
#x <- rpois(100, lambda = 5) # Simulate a data set with Poisson distribution
S <- rarefaction_curve(test_df) # Calculate the rarefaction curve
plot(S, type = "b", xlab = "Sampling effort", ylab = "Number of unique individuals")
df2 <- test_df
min_df =  min(df2[][5:ncol(df2)])
min_df
dim(df1)
# Identify columns with 0 values
zero_cols <- sapply(df1, function(x) all(x == 0))
# Drop columns with 0 values
df1 <- df1[, !zero_cols]
dim(df1)
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'orange', lwd = 2, cex = 0.5)
test_df <- df1[][5:ncol(df1)]
# Define a function to calculate the rarefaction curve for a given proportional abundance data set
rarefaction_curve <- function(p) {
n <- sum(p) # Total number of individuals in the data set
S <- numeric(n) # Number of unique individuals observed at each sampling effort
for(i in 1:n) {
S[i] <- sum(p[1:i] > 0) # Number of unique individuals observed at each sampling effort
}
return(S)
}
df1 <- df1[8,]
