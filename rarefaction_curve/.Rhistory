Strain_4 <- c(12)
Strain_5 <- c(0.2)
df <- data.frame(Samples, Strain_1, Strain_2, Strain_3, Strain_4, Strain_5)
print (df)
rarefy(df, 3)
print (df$Samples)
print (df$Strain_1)
print (df$Samples == 'CMB1')
print (df[0])
print (df[1])
print (df[2])
print (df[2:5])
print (df[0])
print (df[1])
print (df[1][2:5])
print (df[2][2:5])
print (df[][2:5])
print (df[][2:5].values)
print (df[][2:5])
print (df[][2:5][0])
print (df[][2:5][1])
rarefy(df[][2:5], 3)
print (df)
print(df[][2:5])
print(df[][2:5] * 2)
print(min(df[][2:5]))
print(df[][2:5] /(min(df[][2:5])))
df[][2:5] = df[][2:5] /(min(df[][2:5]))
print(df)
df <- data.frame(Samples, Strain_1, Strain_2, Strain_3, Strain_4, Strain_5)
df[][2:5] = df[][2:6] /(min(df[][2:6]))
df[][2:6] = df[][2:6] /(min(df[][2:6]))
print(df)
Samples <- c("CMB1")
Strain_1 <- c(0.1)
Strain_2 <- c(2)
Strain_3 <- c(0.5)
Strain_4 <- c(12)
Strain_5 <- c(0.2)
df <- data.frame(Samples, Strain_1, Strain_2, Strain_3, Strain_4, Strain_5)
print (df)
print (df[][2:5])
rarefy(df[][2:5], 3)
print(df[][2:5] /(min(df[][2:5])))
df[][2:6] = df[][2:6] /(min(df[][2:6]))
print(df)
rarefy(df[][2:6], 3)
S <- 5
Srare <- rarefy(df[][2:6], 3)
#Srare <- rarefy(BCI, raremax)
plot(S, Srare, xlab = "Observed No. of Species", ylab = "Rarefied No. of Species")
print(Srare)
raremax <- min(rowSums(df))
raremax <- min(rowSums(df[][2:6]))
print(raremax)
S <- 5
S <- 5
Srare <- rarefy(df[][2:6], raremax)
#Srare <- rarefy(BCI, raremax)
plot(S, Srare, xlab = "Observed No. of Species", ylab = "Rarefied No. of Species")
#Srare <- rarefy(BCI, raremax)
plot(S, Srare, xlab = "Observed No. of Species", ylab = "Rarefied No. of Species")
rarecurve(df[][2:6], step = 20, sample = raremax, col = "blue", cex = 0.6)
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
df <- read.csv("202109_phylum_with_site.csv", header = TRUE, sep = ",")
df_sub <- subset(df, site == 'KCKT')
df1 <- df
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
df <- read.csv("202109_phylum_with_site.csv", header = TRUE, sep = ",")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
df <- read.csv("202109_phylum_with_site.csv", header = TRUE, sep = ",")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
df <- read.csv("202109_phylum_with_site.csv", header = TRUE, sep = ",")
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
setwd("/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
getwd()
setwd("/GitHub/research_project/rarefaction_curve")
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
df <- read.csv("/GitHub/research_project/rarefaction_curve/full_202109_genera_with_site.csv", header = TRUE, sep = ",")
df <- read.csv("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve/full_202109_genera_with_site.csv", header = TRUE, sep = ",")
df <- read.csv("/Users/15505/Documents/GitHub/research_project/rarefaction_curve/full_202109_genera_with_site.csv", header = TRUE, sep = ",")
df <- read.csv("Users/15505/Documents/GitHub/research_project/rarefaction_curve/full_202109_genera_with_site.csv", header = TRUE, sep = ",")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
setwd("C:/Users/15505/Documents/GitHub/research_project/rarefaction_curve")
require(vegan)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
df1 <- df
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'blue', lwd = 2, cex = 0.5)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'BTU')
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'blue', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
coldf[coldf == "SBR"] <- 'forestgreen'
coldf[coldf == "BTU"] <- 'hotpink'
coldf[coldf == "SKY"] <- 'blue'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'orange'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'blue', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'BTU')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
coldf[coldf == "SBR"] <- 'forestgreen'
coldf[coldf == "BTU"] <- 'hotpink'
coldf[coldf == "SKY"] <- 'blue'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'orange'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = collist, lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
df1 <- df
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
coldf[coldf == "SBR"] <- 'forestgreen'
coldf[coldf == "BTU"] <- 'hotpink'
coldf[coldf == "SKY"] <- 'blue'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'orange'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = collist, lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'WART')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = collist, lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'WART')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'darkred', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'WART')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'darkred', lwd = 2, cex = 0.5)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'SBR')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'forestgreen', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'BTU')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'yellow', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'SKY')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'blue', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'BLDTTT')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'red', lwd = 2, cex = 0.5)
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
unique(df$site)
#df1 <- df
df1 <- subset(df, site == 'KCKT')
numsites = (dim(unique(df1[c('site')]))[1])
print(numsites)
coldf = df[c('site')]
coldf[coldf == "WART"] <- 'darkred'
# Convert the color list to a vector
collist <- as.vector(unlist(coldf))
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
raremax <- min(rowSums(df1[][5:ncol(df1)]))
S <- specnumber(df1)
Srare <- rarefy(df1[][5:ncol(df1)], raremax)
# Plot the rarefaction curve with colored lines
rarecurve(df1[][5:ncol(df1)], step = 20, sample = raremax, col = 'orange', lwd = 2, cex = 0.5)
df <- read.csv("rarefaction_data_202107_phylum.csv", header = TRUE, sep = ",")
df1 <- df[1,]
(dim(df1))
ncol(df1)
df2 <- df1
df2[df2 == 0] <- 25
#head(df)
#head(df1)
min_df =  min(df2[][4:ncol(df1)])
min_df
df1[][4:ncol(df1)]
df1[][4:ncol(df1)] = df1[][4:ncol(df1)] / min_df
#df1[][4:ncol(df1)] = df1[][4:ncol(df1)] * 7303252
#df1[][4:ncol(df1)] = (df1[][4:ncol(df1)]) / 876
#df[][4:ncol(df)] = df[][4:ncol(df)]
print(df1[][4:ncol(df)] )
df1[][4:ncol(df)] = trunc(df1[][4:ncol(df1)])
raremax <- min(rowSums(df1[][4:ncol(df1)]))
S <- specnumber(df1)
print(S)
Srare <- rarefy(df1[][4:ncol(df1)], raremax)
rarecurve <- rarecurve(df1[][4:ncol(df1)], step = 20, sample = raremax, col = "blue", cex = 0.6)
plot(rare_curve, type = "l", col = "blue", xlab = "Number of individuals", ylab = "Number of species")
rare_curve <- rarecurve(df1[][4:ncol(df1)], step = 20, sample = raremax, col = "blue", cex = 0.6)
plot(rare_curve, type = "l", col = "blue", xlab = "Number of individuals", ylab = "Number of species")
lines(rare_curve$upr, col = "grey", lty = "dashed")
lines(rare_curve$lwr, col = "grey", lty = "dashed")
plot(rare_curve, type = "l", col = "blue", xlab = "Number of individuals", ylab = "Number of species")
rare_curve <- rarecurve(df1[][4:ncol(df1)], step = 20, sample = raremax, col = "blue", cex = 0.6)
plot(rare_curve, type = "l", col = "blue", xlab = "Number of individuals", ylab = "Number of species")
lines(rare_curve$upr, col = "red", lty = "dashed")
legend("topleft", legend = c("Rarefaction curve", "95% confidence interval"), lty = c(1, 2), col = c("blue", "grey"))
df <- read.csv("rarefaction_data_202107_phylum.csv", header = TRUE, sep = ",")
df1 <- df[1,]
(dim(df1))
ncol(df1)
df2 <- df1
df2[df2 == 0] <- 25
#head(df)
#head(df1)
min_df =  min(df2[][4:ncol(df1)])
min_df
df1[][4:ncol(df1)]
df1[][4:ncol(df1)] = df1[][4:ncol(df1)] / min_df
#df1[][4:ncol(df1)] = df1[][4:ncol(df1)] * 7303252
#df1[][4:ncol(df1)] = (df1[][4:ncol(df1)]) / 876
#df[][4:ncol(df)] = df[][4:ncol(df)]
print(df1[][4:ncol(df)] )
df1[][4:ncol(df)] = trunc(df1[][4:ncol(df1)])
raremax <- min(rowSums(df1[][4:ncol(df1)]))
S <- specnumber(df1)
print(S)
Srare <- rarefy(df1[][4:ncol(df1)], raremax)
rare_curve <- rarecurve(df1[][4:ncol(df1)], step = 20, sample = raremax, col = "blue", cex = 0.6)
plot(rare_curve, type = "l", col = "blue", xlab = "Number of individuals", ylab = "Number of species")
lines(rare_curve$upr, col = "red", lty = "dashed")
lines(rare_curve$lwr, col = "red", lty = "dashed")
plot(rare_curve$upr, col = "red", lty = "dashed")
print(rare_curve$upr)
print(rare_curve$lwr)
rare_curve <- rarecurve(df1[][4:ncol(df1)], step = 20, sample = raremax, col = "blue", cex = 0.6)
print(rare_curve$lwr)
#plot(S, Srare, xlab = "Observed No. of Species", ylab = "Rarefied No. of Species")
rare_curve <- rarecurve(df1[][4:ncol(df1)], sample = raremax, step = 10)
plot(rare_curve, type = "l", col = "blue", xlab = "Number of individuals", ylab = "Number of species")
lines(rare_curve$upr, col = "red", lty = "dashed")
lines(rare_curve$lwr, col = "red", lty = "dashed")
legend("topleft", legend = c("Rarefaction curve", "95% confidence interval"), lty = c(1, 2), col = c("blue", "grey"))
print(rare_curve$lwr)
print(rare_curve$upper)
print(rare_curve$upr)
require(vegan)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
df1 <- df[1,]
df1
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
print(df1[][5:7])
# Add 95% confidence intervals
boot_curve <- rarecurve.bootstrap(sipoo, step = 10, nsim = 100)
# Add 95% confidence intervals
boot_curve <- rarecurve.bootstrap(sipoo, step = 10, nsim = 100)
rarecurve(sipoo, step = 10, label = TRUE, col = "blue")
sipoo <- (df1[][5:7])
rarecurve(sipoo, step = 10, label = TRUE, col = "blue")
require(vegan)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("full_202109_genera_with_site.csv", header = TRUE, sep = ",")
df1 <- df[1,]
df2 <- df1
df2[df2 == 0] <- 25
min_df =  min(df2[][5:ncol(df2)])
min_df
df1[][5:ncol(df1)] = df1[][5:ncol(df1)] / min_df
df1[][5:ncol(df1)] = trunc(df1[][5:ncol(df1)])
sipoo <- (df1[][5:ncol(df1))
sipoo <- (df1[][5:ncol(df1)
rarecurve(sipoo, step = 10, label = TRUE, col = "blue")
sipoo <- (df1[][5:ncol(df1))
sipoo <- df1[][5:ncol(df1)
rarecurve(sipoo, step = 10, label = TRUE, col = "blue")
sipoo <- df1[][5:ncol(df1)
rarecurve(sipoo, step = 10, label = TRUE, col = "blue")
sipoo <- df1[][5:ncol(df1)]
rarecurve(sipoo, step = 10, label = TRUE, col = "blue")
# Add 95% confidence intervals
boot_curve <- rarecurve.bootstrap(sipoo, step = 10, nsim = 100)
library(boot)
# Define a function to calculate rarefaction curves
calc_rarefaction <- function(data, i) {
rarecurve(data[i, ], step = 10, label = FALSE, col = "blue", xlab = "Number of individuals", ylab = "Expected number of species")
}
# Generate bootstrapped rarefaction curves
boot_curve <- boot(data = sipoo, statistic = calc_rarefaction, R = 100)
