coldf[coldf == "SBR"] <- 'darkred'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf[coldf == "KCKT"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-10, 10), ylim = c(-10,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
#,
fill = c('darkred','forestgreen','yellow','blue','red','orange')
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'darkred'
coldf[coldf == "FRW"] <- 'darkgreen'
coldf[coldf == "MMP"] <- 'yellow'
coldf[coldf == "PNR"] <- 'darkgreen'
coldf[coldf == "CMB"] <- 'red'
coldf[coldf == "RF"] <- 'darkgreen'
coldf[coldf == "SLG"] <- 'darkred'
coldf[coldf == "LFS"] <- 'yellow'
coldf[coldf == "SGC"] <- 'yellow'
coldf[coldf == "RGT"] <- 'red'
coldf[coldf == "HR"] <- 'red'
coldf[coldf == "PTW"] <- 'darkgreen'
coldf[coldf == "GH"] <- 'darkred'
coldf[coldf == "LM"] <- 'yellow'
coldf[coldf == "MKP"] <- 'yellow'
coldf[coldf == "TCP"] <- 'yellow'
coldf[coldf == "WART"] <- 'maroon'
coldf[coldf == "SBR"] <- 'darkgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf[coldf == "KCKT"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-10, 10), ylim = c(-10,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-10,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'darkred'
coldf[coldf == "FRW"] <- 'darkgreen'
coldf[coldf == "MMP"] <- 'yellow'
coldf[coldf == "PNR"] <- 'darkgreen'
coldf[coldf == "CMB"] <- 'red'
coldf[coldf == "RF"] <- 'darkgreen'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'yellow'
coldf[coldf == "SGC"] <- 'yellow'
coldf[coldf == "RGT"] <- 'red'
coldf[coldf == "HR"] <- 'red'
coldf[coldf == "PTW"] <- 'darkgreen'
coldf[coldf == "GH"] <- 'darkred'
coldf[coldf == "LM"] <- 'yellow'
coldf[coldf == "MKP"] <- 'yellow'
coldf[coldf == "TCP"] <- 'yellow'
coldf[coldf == "WART"] <- 'maroon'
coldf[coldf == "SBR"] <- 'darkgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf[coldf == "KCKT"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
coldf[coldf == "RRL"] <- 'blue'
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'darkgreen'
coldf[coldf == "MMP"] <- 'yellow'
coldf[coldf == "PNR"] <- 'darkgreen'
coldf[coldf == "CMB"] <- 'red'
coldf[coldf == "RF"] <- 'darkgreen'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'yellow'
coldf[coldf == "SGC"] <- 'yellow'
coldf[coldf == "RGT"] <- 'red'
coldf[coldf == "HR"] <- 'red'
coldf[coldf == "PTW"] <- 'darkgreen'
coldf[coldf == "GH"] <- 'darkred'
coldf[coldf == "LM"] <- 'yellow'
coldf[coldf == "MKP"] <- 'yellow'
coldf[coldf == "TCP"] <- 'yellow'
coldf[coldf == "WART"] <- 'maroon'
coldf[coldf == "SBR"] <- 'darkgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf[coldf == "KCKT"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'yellow'
coldf[coldf == "PNR"] <- 'darkgreen'
coldf[coldf == "CMB"] <- 'red'
coldf[coldf == "RF"] <- 'darkgreen'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'yellow'
coldf[coldf == "SGC"] <- 'yellow'
coldf[coldf == "RGT"] <- 'red'
coldf[coldf == "HR"] <- 'red'
coldf[coldf == "PTW"] <- 'darkgreen'
coldf[coldf == "GH"] <- 'darkred'
coldf[coldf == "LM"] <- 'yellow'
coldf[coldf == "MKP"] <- 'yellow'
coldf[coldf == "TCP"] <- 'yellow'
coldf[coldf == "WART"] <- 'maroon'
coldf[coldf == "SBR"] <- 'darkgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf[coldf == "KCKT"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'yellow'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'red'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'yellow'
coldf[coldf == "SGC"] <- 'yellow'
coldf[coldf == "RGT"] <- 'red'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'darkgreen'
coldf[coldf == "GH"] <- 'darkred'
coldf[coldf == "LM"] <- 'yellow'
coldf[coldf == "MKP"] <- 'yellow'
coldf[coldf == "TCP"] <- 'yellow'
coldf[coldf == "WART"] <- 'maroon'
coldf[coldf == "SBR"] <- 'darkgreen'
coldf[coldf == "BTU"] <- 'yellow'
coldf[coldf == "SKY"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf[coldf == "KCKT"] <- 'yellow'
coldf[coldf == "BLDTTT"] <- 'yellow'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
coldf[coldf == "WART"] <- 'red'
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'yellow'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'red'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'yellow'
coldf[coldf == "SGC"] <- 'yellow'
coldf[coldf == "RGT"] <- 'red'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'darkgreen'
coldf[coldf == "GH"] <- 'darkred'
coldf[coldf == "LM"] <- 'yellow'
coldf[coldf == "MKP"] <- 'yellow'
coldf[coldf == "TCP"] <- 'yellow'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'green'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'green'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'green'
coldf[coldf == "SGC"] <- 'green'
coldf[coldf == "RGT"] <- 'green'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'green'
coldf[coldf == "GH"] <- 'green'
coldf[coldf == "LM"] <- 'green'
coldf[coldf == "MKP"] <- 'green'
coldf[coldf == "TCP"] <- 'green'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
summary(pca)
plot(pc3, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
#,
fill = c('darkred','forestgreen','yellow','blue','red','orange')
legend(8, 10, legend=c(unique(data$site)), cex = 1)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
df <- read.csv("plant_microbe_phylum.csv", header = TRUE, sep = ",")
df1 = df[][4:ncol(df)]
head(df1)
head(df)
# calculate diversity indices by site
shannon_diversity <- diversity(df1, index = "shannon")
simpson_diversity <- diversity(df1, index = "simpson")
df$shannon <- shannon_diversity
df$simpson <- simpson_diversity
unique(df$Site)
boxplot(df$shannon ~ df$Site, df,                                # Change main title and axis labels
main = "Shannon Diversity of Plant Microbiome Phylum by Site",
xlab = "Site",
ylab = "Shannon Diversity",
col = c('blue', 'red', 'darkgreen', 'yellow', 'orange', 'purple'),
ylim = c(0.3, 1.8),
names=unique(df$Site),
show.names = TRUE)
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("soil_microbe_genus.csv", header = TRUE, sep = ",")
dim(data)
unique(data$Site)
dim(data)
# Perform a PCA on the dataset
pca <- prcomp(data[][4:ncol(data)], center = TRUE, scale. = TRUE)
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'green'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'green'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'green'
coldf[coldf == "SGC"] <- 'green'
coldf[coldf == "RGT"] <- 'green'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'green'
coldf[coldf == "GH"] <- 'green'
coldf[coldf == "LM"] <- 'green'
coldf[coldf == "MKP"] <- 'green'
coldf[coldf == "TCP"] <- 'green'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
coldf
pc1
unique(data$site)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("soil_microbe_genus.csv", header = TRUE, sep = ",")
# Perform a PCA on the dataset
pca <- prcomp(data[][4:ncol(data)], center = TRUE, scale. = TRUE)
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'green'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'green'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'green'
coldf[coldf == "SGC"] <- 'green'
coldf[coldf == "RGT"] <- 'green'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'green'
coldf[coldf == "GH"] <- 'green'
coldf[coldf == "LM"] <- 'green'
coldf[coldf == "MKP"] <- 'green'
coldf[coldf == "TCP"] <- 'green'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
#,
fill = c('darkred','forestgreen','yellow','blue','red','orange')
legend(8, 10, legend=c(unique(data$site)), cex = 1)
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("soil_microbe_genus.csv", header = TRUE, sep = ",")
# Load the iris dataset
#data <- subset(data, site == 'FRW' | site == 'RRL')
data <- data[, colSums(data != 0) > 0]
# Perform a PCA on the dataset
pca <- prcomp(data[][4:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
pc3 <- pca$x[,3]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'green'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'green'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'green'
coldf[coldf == "SGC"] <- 'green'
coldf[coldf == "RGT"] <- 'green'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'green'
coldf[coldf == "GH"] <- 'green'
coldf[coldf == "LM"] <- 'green'
coldf[coldf == "MKP"] <- 'green'
coldf[coldf == "TCP"] <- 'green'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-15, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-20, 10), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-20, 20), ylim = c(-15,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-20, 20), ylim = c(-2,10), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-20, 20), ylim = c(-20,20), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-20, 20), ylim = c(-20,30), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-50, 50), ylim = c(-50,50), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-70,40), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-20, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
45
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(2.4)", ylab = "PC2(2.1)", main = "PCA plot of Plant Microbe Sites by Phylum")
summary(pca)
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(0)", ylab = "PC2(0)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(0%)", ylab = "PC2(0%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
# Load required libraries
library(vegan)
library(ggplot2)
setwd("C:/Users/15404/Documents/GitHub/research_project/rarefaction_curve/")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("plant_microbe_genus.csv", header = TRUE, sep = ",")
# Load the iris dataset
#data <- subset(data, site == 'FRW' | site == 'RRL')
data <- data[, colSums(data != 0) > 0]
# Perform a PCA on the dataset
pca <- prcomp(data[][4:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
pc3 <- pca$x[,3]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'green'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'green'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'green'
coldf[coldf == "SGC"] <- 'green'
coldf[coldf == "RGT"] <- 'green'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'green'
coldf[coldf == "GH"] <- 'green'
coldf[coldf == "LM"] <- 'green'
coldf[coldf == "MKP"] <- 'green'
coldf[coldf == "TCP"] <- 'green'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
#,
fill = c('darkred','forestgreen','yellow','blue','red','orange')
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-100, 100), ylim = c(-100,100), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-100, 100), ylim = c(-100,50), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-100, 100), ylim = c(-20,50), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-100, 100), ylim = c(-25,50), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-100, 10), ylim = c(-25,50), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-70, 10), ylim = c(-25,50), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
# Read data from a file or create a data frame with relative abundance data
data <- read.csv("soil_microbe_genus.csv", header = TRUE, sep = ",")
# Load the iris dataset
#data <- subset(data, site == 'FRW' | site == 'RRL')
data <- data[, colSums(data != 0) > 0]
# Perform a PCA on the dataset
pca <- prcomp(data[][4:ncol(data)], center = TRUE, scale. = TRUE)
summary(pca)
# Extract the first two principal components
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
pc3 <- pca$x[,3]
unique(data$site)
# Create a color vector based on the species of iris
site <- data$site
coldf = data[c('site')]
coldf[coldf == "RRL"] <- 'blue'
coldf[coldf == "FRW"] <- 'blue'
coldf[coldf == "MMP"] <- 'green'
coldf[coldf == "PNR"] <- 'blue'
coldf[coldf == "CMB"] <- 'green'
coldf[coldf == "RF"] <- 'blue'
coldf[coldf == "SLG"] <- 'blue'
coldf[coldf == "LFS"] <- 'green'
coldf[coldf == "SGC"] <- 'green'
coldf[coldf == "RGT"] <- 'green'
coldf[coldf == "HR"] <- 'blue'
coldf[coldf == "PTW"] <- 'green'
coldf[coldf == "GH"] <- 'green'
coldf[coldf == "LM"] <- 'green'
coldf[coldf == "MKP"] <- 'green'
coldf[coldf == "TCP"] <- 'green'
coldf[coldf == "WART"] <- 'red'
coldf[coldf == "SBR"] <- 'red'
coldf[coldf == "BTU"] <- 'red'
coldf[coldf == "SKY"] <- 'red'
coldf[coldf == "BLDTTT"] <- 'red'
coldf[coldf == "KCKT"] <- 'red'
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Plant Microbe Sites by Phylum")
#legend("topright", legend = levels(unique(data$site)), col = coldf$site,
#       pch = 19, bty = "n")
#,
fill = c('darkred','forestgreen','yellow','blue','red','orange')
plot(pc1, pc2, cex =1,pch = 19, xlim = c(-45, 40), ylim = c(-50,40), col = coldf$site,
xlab = "PC1(15.2%)", ylab = "PC2(4%)", main = "PCA plot of Soil Microbe Sites by Genus")
